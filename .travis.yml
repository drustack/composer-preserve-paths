---

sudo: false

dist: trusty

language: php

before_install:
  - sh -c "if [ $TRAVIS_PHP_VERSION != hhvm ]; then phpenv config-rm xdebug.ini; fi"
  - sh -c "if [ $TRAVIS_PHP_VERSION != hhvm ]; then echo 'sendmail_path = /bin/true' >> ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/travis.ini; fi"
  - composer self-update
  - composer global require --no-update hirak/prestissimo:@stable
  - composer global require --no-update phpunit/phpunit:@stable
  - composer global require --no-update satooshi/php-coveralls:@stable
  - composer global update
  - export PATH="$PATH:$HOME/.composer/vendor/bin"

install:
  - composer install --prefer-source

before_script:
  - mkdir -p build/logs

script:
  - composer phpunit

after_script:
  - composer coveralls

matrix:
  include:
    - php: 5.6
    - php: 7.0
    - php: hhvm
  allow_failures:
    - php: 7.0
    - php: hhvm
